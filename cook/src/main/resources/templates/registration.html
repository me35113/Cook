<!-- index.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">

<title>ë ˆì‹œí”¼ ë“±ë¡</title>
<style>
* {
font-family: "Gowun Dodum", sans-serif;
    margin: 0;
    padding: 0;
}

body {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    padding-top: 100px; /* top.jspì˜ ë†’ì´ë§Œí¼ ì—¬ë°± ì¶”ê°€ */
    overflow-x: hidden;
}

.wrapper {
    flex: 1;
    display: flex;
    justify-content: center; /* ì´ ì¤„ ì¶”ê°€ */
    width: 100%;
}

.container {
    display: flex;
    width: 100%;       
    max-width: 1200px; /* ì´ ì¤„ ì¶”ê°€ - ìµœëŒ€ ë„ˆë¹„ ì œí•œ */
    min-height: 250vh;
}

.panel {
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 18px;
    font-weight: bold;
}

/* ë ˆì‹œí”¼ ë“±ë¡ í¼ ìŠ¤íƒ€ì¼ */
.recipe-form {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
     padding: 0 20px; /* ì´ ì¤„ ì¶”ê°€ - ì¢Œìš° ì—¬ë°± */
    margin-left: 0
}

.form-header {
    padding-bottom: 10px;
    margin-bottom: 20px;
    font-size: 24px;
    font-weight: bold;
    padding-top: 50px;
    text-align: center;
}

.form-group {
    margin-bottom: 20px;
    display: flex;
    align-items: flex-start;
}

.form-label {
    width: 100px;
    font-size: 20px;
    font-weight: bold;
    padding-top: 50px;
}

.form-input {
    flex: 1;
    margin-top: 46px;
    margin-left: 30px;
    align-items: center;
}

.text-input {
    width: 60%;
    padding: 10px;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
    border-radius: 10px;
    margin-left: 20px;
    /*margin-bottom: 100px;*/
    font-size: 16px;
}

.textarea-input {
    width: 60%;
    padding: 10px;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
    resize: none;
    height: 100px;
    border-radius: 10px;
    margin-left: 20px;
    font-size: 16px;
}

.image-upload {
    display: flex;
    align-items: center;
    gap: 20px;
}

.image-preview {
    width: 150px;
    height: 150px;
    border: 1px solid #ddd;
    background-color: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    cursor: pointer;
    border-radius: 10px;
}

.image-preview img {
    max-width: 100%;
    max-height: 100%;
    border-radius: 10px;
}

.image-text {
    text-align: center;
    color: #999;
    font-size: 12px;
    margin-top: 5px;
}

.video-upload {
    display: flex;
    gap: 10px;
    align-items: center;
}

.video-input {
    width: 60%;
    padding: 10px;
    height: 100px;
    resize: none;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
    border-radius: 10px;
    margin-left: 20px;
    font-size: 16px;
}

.video-upload-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    align-items: center;
    margin-left: 30px;
    
    height: 118px;
}

.video-button {
    position: relative;
    padding: 9px 15px;
    background-color: #f1f1f1;
    border: 1px solid #ccc;
    width: 100%;
    height: 100%;
    margin-left: 10px;
    border-radius: 10px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 5px;
}

.video-preview-player {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 10px;
}

.material-icons {
    font-size: 24px;
    color: #999;
}

.category-section {
    display: flex;
    margin-top: 10px;
}

.category-column {
    flex: 1;
    margin-right: 10px;
    margin-left: 20px;
}

.category-title {
    font-weight: bold;
    margin-bottom: 10px;
	font-size: 18px;
}

.category-items {
    display: flex;
    flex-direction: column;
    margin-top: 20px;
}

.category-item {
    margin-bottom: 6px;
    font-size: 16px;
}

.cooking-info-section {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
}

.info-item {
    display: flex;
    flex-direction: column;
    background-color: #f1f1f1;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 10px;
    width: 120px;
    text-align: center;
}

.info-title {
    font-weight: bold;
    margin-bottom: 6px;
    font-size: 16px;
}

.info-input-container {
    display: flex;
    justify-content: center;
}

.info-input {
    width: 60px;
    padding: 5px;
    border: 1px solid #ddd;
    text-align: center;
    border-radius: 3px;
}

.horizontal-layout {
    display: flex;
    width: 100%;
    margin-bottom: 30px;
}

.label-column {
    width: 120px;
    font-size: 20px;
    font-weight: bold;
    padding-top: 20px;
}

.content-column {
    flex: 1;
    margin-left: 25px;
}

.recipe-steps-section {
    margin-top: 40px;
    margin-bottom: 40px;
}

.step-item {
    margin-bottom: 30px;
    width: 100%;
}

.step-header {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.step-number {
    font-weight: bold;
    margin-top: 10px;
}

.step-content {
    display: flex;
    width: 100%;
    justify-content: space-between;
    gap: 20px;
}

.step-text-container {
    flex: 1;
    display: flex;
}

.step-text-input {
    width: 100%;
    height: 100px;
    padding: 10px;
    border: 1px solid #ddd;
    background-color: #f1f1f1;
    resize: none;
    border-radius: 10px;
    font-size: 16px;
}

.step-image-container {
    width: 120px;
    height: 120px;
}

.step-image-upload {
    width: 100%;
    height: 100%;
    border: 1px solid #ddd;
    background-color: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
}

.image-icon, .photo-icon {
    font-size: 30px;
    color: #ccc;
}

.completed-photos-section {
    margin-bottom: 30px;
}

.completed-photos-container {
    display: flex;
    gap: 15px;
}

.completed-photo-item {
    width: 150px;
    height: 150px;
    border: 1px solid #ddd;
    background-color: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 15px;
}

.cooking-tip-section {
    margin-bottom: 30px;
}

.cooking-tip-container {
    width: 100%;
}

.cooking-tip-input {
    width: 100%;
    height: 100px;
    padding: 10px;
    border: 1px solid #ddd;
    background-color: #f1f1f1;
    resize: none;
    margin-top: 20px;
    border-radius: 10px;
    font-size: 16px;
}

.tag-section {
    margin-bottom: 30px;
}

.tag-container {
    width: 100%;
    margin-bottom: 10px;
}

.tag-input {
    width: 100%;
    height: 50px;
    padding: 10px;
    border: 1px solid #ddd;
    background-color: #f1f1f1;
    margin-top: 20px;
    border-radius: 10px;
}

.tag-helper-text {
    font-size: 14px;
    color: #888;
    margin-top: 5px;
    margin-left: 5px;
    font-weight: bold;
}

.button-group {
    display: flex;
    justify-content: center;
    margin-top: 40px;
    gap: 40px;
   margin-bottom: 50px; /* ì´ ì¤„ ì¶”ê°€ - í•˜ë‹¨ ì—¬ë°± */
    margin-left: 0; /
}

.cancel-btn {
    padding: 10px 30px;
    background-color: #FFFAE9;
    color: #D94C4C;
    border: none;
    cursor: pointer;
    border-radius: 10px;
    width: 160px;

    border: 1px solid #D94C4C;
    font-size: 16px;
}

.save-temp-btn {
    padding: 10px 30px;
    background-color: #e74c3c;
    color: #FFFAE9;
    border: 1px solid #ddd;
    border-color: #d94c4c;
    cursor: pointer;
    border-radius: 10px;
    width: 160px;

	font-size: 16px;
}

.complete-btn {
    padding: 10px 30px;
    background-color: #FFFAE9;
    color: #D94C4C;
    border: 1px solid;
    border-color: #d94c4c;
    cursor: pointer;
    border-radius: 10px;
    width: 120px;
    margin-left: 70px;
}

.category-column {
    flex: 1;
    margin-right: 10px;
    margin-left: 20px;
    position: relative;
}

.category-column:nth-child(1)::after, .category-column:nth-child(2)::after {
    content: "";
    position: absolute;
    top: 0;
    right: -10px;
    width: 1px;
    height: 100%;
    background-color: #A49177;
}
.category-column:nth-child(2),
.category-column:nth-child(3) {
    margin-left: 40px; /* ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ì¡°ì ˆ */
}
.ingredient-group-header {
    background-color: white;
    padding: 6px 10px;
    border-radius: 5px;
    font-weight: bold;
    margin-bottom: 10px;
    border: none;
    outline: none;
    width: 30%;
    font-size: 16px;
    color: black;
    border : 1px solid #7A9E9F;
}

.ingredient-group-header::placeholder {
    color: #888;
    font-weight: normal;
}

.ingredient-row {
    margin-bottom: 10px;
}

.ingredient-row input {
    background-color: #f1f1f1;
    padding: 8px;
    border: 1px solid #ddd;
    text-align: center;
    border-radius: 5px;
}

.add-ingredient-btn {
    padding: 6px 15px;
    border: 1px solid #d94c4c;
    border-radius: 5px;
    cursor: pointer;
    color: #D94C4C;
    background-color: #fffae9;
    margin-top: 10px;
}

.add-btn {
	padding: 8px 20px; 
	border: 1px solid #d94c4c; 
	border-radius: 5px; 
	cursor: pointer; 
	width: 120px; 
	color: #D94C4C; 
	background-color: #fffae9;
	margin: 0 10px;
	font-size: 14px;
	font-weight: bold;
}
.ingredient-row input {
	font-size: 14px;
}
</style>
</head>
<!-- âœ… ìƒë‹¨ë°” í¬í•¨ -->
<div th:replace="top :: topFragment"></div>
<body>
    <!-- Spring Boot ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ì „ì†¡í•˜ë„ë¡ action ë³€ê²½ -->
    <form method="post" action="/registration" th:object="${recipe}" enctype="multipart/form-data" onsubmit="beforeSubmit(); return false;">

        <input type="hidden" name="ingredients" id="ingredients-hidden">
        <input type="hidden" name="steps" id="steps-hidden">
        
        <!-- ì‚¬ìš©ì IDëŠ” ì‹¤ì œë¡œëŠ” ì„¸ì…˜ì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨ -->
        <input type="hidden" name="userId" value="abcd"> <!-- ì„ì‹œë¡œ ê³ ì • -->

        <div class="wrapper">
            <div class="container">
                <div class="panel left-panel">ì™¼ìª½ íŒ¨ë„</div>
                <div class="content">
                    <div class="recipe-form">
                        <!-- ì„±ê³µ/ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ -->
                        <div th:if="${message}" class="alert alert-success" style="color: green; padding: 10px; margin: 10px 0; border: 1px solid #d4edda; background-color: #d1ecf1; border-radius: 5px;">
                            <span th:text="${message}"></span>
                        </div>
                        <div th:if="${error}" class="alert alert-error" style="color: red; padding: 10px; margin: 10px 0; border: 1px solid #f5c6cb; background-color: #f8d7da; border-radius: 5px;">
                            <span th:text="${error}"></span>
                        </div>

                        <div class="form-header">ë ˆì‹œí”¼ ë“±ë¡</div>

                        <!-- ë ˆì‹œí”¼ ì œëª© + ëŒ€í‘œ ì´ë¯¸ì§€ -->
                        <div class="form-group">
                            <div class="form-label">ë ˆì‹œí”¼ ì œëª©</div>
                            <div class="form-input" style="display: flex; align-items: center; gap: 50px;">
                                <input type="text" class="text-input" name="title" th:field="*{title}" placeholder="ì˜ˆ) ì†Œê³ ê¸° ë¯¸ì—­êµ­ ë“ì´ê¸°" required>
                            </div>
                        </div>

                        <!-- ìš”ë¦¬ ì†Œê°œ -->
                        <div class="form-group">
                            <div class="form-label">ìš”ë¦¬ ì†Œê°œ</div>
                            <div class="form-input">
                                <textarea class="textarea-input" name="description" th:field="*{description}" placeholder="ì´ ë ˆì‹œí”¼ì˜ íƒ„ìƒë°°ê²½ì„ ì ì–´ì£¼ì„¸ìš”." required></textarea>
                            </div>
                        </div>

                        <!-- ë™ì˜ìƒ ì—…ë¡œë“œ ì„¹ì…˜ -->
                        <div class="form-group">
                            <div class="form-label">ë™ì˜ìƒ</div>
                            <div class="form-input">
                                <div class="video-upload">
                                    <textarea type="text" class="video-input" name="videosUrl" th:field="*{videosUrl}" placeholder="ìœ íŠœë¸Œ ì£¼ì†Œ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                                    <div class="video-upload-container">
                                        <input type="file" class="video-file-input" accept="video/*" style="display: none;" onchange="previewVideo(this)">
                                        <button type="button" class="video-button" onclick="this.parentElement.querySelector('.video-file-input').click()">
                                            <span class="material-icons video-icon">ğŸ¥</span>
                                            <span class="video-text">ì˜ìƒ ì—…ë¡œë“œ</span>
                                            <video class="video-preview-player" controls style="display: none; width: 100%; height: 100%; border-radius: 10px;">
                                                <source type="video/mp4">
                                                <source type="video/webm">
                                                ë¸Œë¼ìš°ì €ê°€ ë™ì˜ìƒì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                                            </video>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ì¹´í…Œê³ ë¦¬ -->
                        <div class="form-group">
                            <div class="form-label">ì¹´í…Œê³ ë¦¬</div>
                            <div class="form-input">
                                <div class="category-section">
                                    <div class="category-column">
                                        <div class="category-title">ì¢…ë¥˜ë³„</div>
                                        <div class="category-items">
                                            <label class="category-item"><input type="checkbox" name="category" value="ë°˜ì°¬"> ë°˜ì°¬</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="êµ­/íƒ•"> êµ­/íƒ•</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë””ì €íŠ¸"> ë””ì €íŠ¸</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë©´/íŒŒìŠ¤íƒ€"> ë©´/íŒŒìŠ¤íƒ€</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë°¥/ì£½/ë–¡"> ë°¥/ì£½/ë–¡</label>
                                        </div>
                                    </div>
                                    <div class="category-column">
                                        <div class="category-title">ì¬ë£Œë³„</div>
                                        <div class="category-items">
                                            <label class="category-item"><input type="checkbox" name="category" value="ì†Œê³ ê¸°"> ì†Œê³ ê¸°</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë¼ì§€ê³ ê¸°"> ë¼ì§€ê³ ê¸°</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë‹­ê³ ê¸°"> ë‹­ê³ ê¸°</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ì±„ì†Œë¥˜"> ì±„ì†Œë¥˜</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="í•´ë¬¼ë¥˜"> í•´ë¬¼ë¥˜</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë‹¬ê±€/ìœ ì œí’ˆ"> ë‹¬ê±€/ìœ ì œí’ˆ</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë²„ì„¯ë¥˜"> ë²„ì„¯ë¥˜</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ì½©/ê²¬ê³¼ë¥˜"> ì½©/ê²¬ê³¼ë¥˜</label>
                                        </div>
                                    </div>
                                    <div class="category-column">
                                        <div class="category-title">ë‚˜ë¼ë³„</div>
                                        <div class="category-items">
                                            <label class="category-item"><input type="checkbox" name="category" value="í•œì‹"> í•œì‹</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ì¼ì‹"> ì¼ì‹</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ì¤‘ì‹"> ì¤‘ì‹</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë² íŠ¸ë‚¨"> ë² íŠ¸ë‚¨</label>
                                            <label class="category-item"><input type="checkbox" name="category" value="ë‚¨ë¯¸"> ë‚¨ë¯¸</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ìš”ë¦¬ì •ë³´ ì„¹ì…˜ -->
                        <div class="form-group">
                            <div class="form-label">ìš”ë¦¬ì •ë³´</div>
                            <div class="form-input">
                                <div class="cooking-info-section">
                                    <!-- ê¸°ì¡´ ì½”ë“œì—ì„œ ì´ ë¶€ë¶„ì„ ì°¾ì•„ì„œ ìˆ˜ì •í•˜ì„¸ìš” -->
<div class="info-item">
    <div class="info-title">ì¸ì›</div>
    <div class="info-input-container">
        <input type="number" class="info-input" name="servingCount" th:field="*{servingCount}" 
               value="1" min="1" max="10" required>
    </div>
</div>
                                    <div class="info-item">
                                        <div class="info-title">ì‹œê°„</div>
                                        <div class="info-input-container">
                                            <input type="text" class="info-input" name="cookingTime" th:field="*{cookingTime}" placeholder="ì˜ˆ) 30ë¶„" required>
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-title">ë‚œì´ë„</div>
                                        <div class="info-input-container">
                                            <select class="info-input" name="level" th:field="*{level}" required>
                                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                                <option value="ì‰¬ì›€">ì‰¬ì›€</option>
                                                <option value="ë³´í†µ">ë³´í†µ</option>
                                                <option value="ì–´ë ¤ì›€">ì–´ë ¤ì›€</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ì¬ë£Œì •ë³´ ì„¹ì…˜ (ê¸°ì¡´ê³¼ ë™ì¼) -->
                        <div class="form-group">
                            <div class="form-label">ì¬ë£Œì •ë³´</div>
                            <div class="form-input" id="ingredients-container">
                                <div class="ingredient-group">
                                    <input type="text" class="ingredient-group-header" name="group_name[]" value="ì¬ë£Œ" readonly>
                                    <div class="ingredient-row" style="margin-bottom: 10px;">
                                        <div class="ingredient-input" style="display: grid; grid-template-columns: 200px 1fr 100px 100px 1fr; gap: 10px; border-radius: 0px; overflow: hidden;">
                                            <input type="text" name="ingredient_name[]" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="ì˜ˆ) ë°°ì¶”ê¹€ì¹˜">
                                            <input type="text" name="quantity1[]" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="10(ìˆ˜ëŸ‰)">
                                            <input type="text" name="quantity2[]" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="ì˜ˆ) g,ml">
                                            <input type="text" name="quantity3[]" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="ì˜ˆ) (ë¹„ê³ )">
                                        </div>
                                    </div>
                                    <!-- ì¶”ê°€ ì¬ë£Œ í–‰ë“¤... -->
                                </div>
                                <div style="text-align: center; margin-top: 20px;">
                                    <button class="add-btn" type="button" onclick="addIngredientGroup()">ê·¸ë£¹ ì¶”ê°€</button>
                                    <button class="add-btn" type="button" onclick="addIngredientRow(this)">ì¬ë£Œ ì¶”ê°€</button>
                                </div>
                            </div>
                        </div>

                        <!-- ìš”ë¦¬ ìˆœì„œ ì„¹ì…˜ (ê¸°ì¡´ê³¼ ë™ì¼) -->
                        <div class="recipe-steps-section">
                            <div class="horizontal-layout">
                                <div class="label-column">ìš”ë¦¬ìˆœì„œ</div>
                                <div class="content-column">
                                    <div id="steps-container">
                                        <div class="step-item">
                                            <div class="step-header">
                                                <div class="step-number">STEP 1</div>
                                            </div>
                                            <div class="step-content">
                                                <div class="step-text-container">
                                                    <textarea class="step-text-input" placeholder="ì˜ˆ) ì†Œê³ ê¸°ëŠ” ê¸°ë¦„ê¸°ë¥¼ ë–¼ì–´ë‚´ê³  ì ë‹¹í•œ í¬ê¸°ë¡œ ì°ì–´ì£¼ì„¸ìš”."></textarea>
                                                </div>
                                                <div class="step-image-container">
                                                    <div class="step-image-upload">
                                                        <input type="file" class="step-file-input" name="step_image_0" accept="image/*" style="display: none;" onchange="previewStepImage(this)">
                                                        <div class="image-icon">+</div>
                                                        <img class="step-preview-image" style="max-width: 100%; max-height: 100%; display: none;" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="button" onclick="addStep()" style="padding: 8px 20px; border: 1px solid #d94c4c; border-radius: 5px; cursor: pointer; display: block; width: 120px; margin: 20px auto; color: #D94C4C; background-color: #fffae9; font-size: 14px; font-weight: bold;">ìˆœì„œì¶”ê°€</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                   <!-- ìš”ë¦¬ì™„ì„±ì‚¬ì§„ ì„¹ì…˜ ìˆ˜ì • -->
<div class="completed-photos-section">
    <div class="horizontal-layout">
        <div class="label-column">ìš”ë¦¬ì™„ì„±ì‚¬ì§„</div>
        <div class="content-column">
            <div class="completed-photos-container">
                <div class="completed-photo-item" onclick="document.querySelector('input[name=complete_img]').click();">
                    <input type="file" name="complete_img" class="completed-file-input" accept="image/*" style="display: none;" onchange="previewCompletedImage(this)" required>
                    <div class="photo-icon">+</div>
                    <img class="completed-preview-image" style="max-width: 100%; max-height: 100%; display: none;" />
                </div>
            </div>
        </div>
    </div>
</div>

                        <!-- ìš”ë¦¬íŒ ì„¹ì…˜ -->
                        <div class="cooking-tip-section">
                            <div class="horizontal-layout">
                                <div class="label-column">ìš”ë¦¬íŒ</div>
                                <div class="content-column">
                                    <div class="cooking-tip-container">
                                        <textarea class="cooking-tip-input" name="tip" th:field="*{tip}" placeholder="ì˜ˆ) ê³ ê¸° ì¡ë‚´ëŠ” ì´ë ‡ê²Œ ì œê±°í•´ìš”!"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- íƒœê·¸ ì„¹ì…˜ -->
                        <div class="tag-section">
                            <div class="horizontal-layout">
                                <div class="label-column">íƒœê·¸</div>
                                <div class="content-column">
                                    <div class="tag-container">
                                        <input type="text" class="tag-input" name="tags" th:field="*{tags}" placeholder="">
                                    </div>
                                    <div class="tag-helper-text">ì£¼ì¬ë£Œ, ëª©ì , íš¨ëŠ¥, ëŒ€ìƒ ë“±ì„ íƒœê·¸ë¡œ ë‚¨ê²¨ì£¼ì„¸ìš”. ì˜ˆ) ë‹­ê³ ê¸°, ë‹¤ì´ì–´íŠ¸, ë¹„ë§Œ, ì²­ì†Œë…„, ê°„ì‹ê±°ë¦¬, ì´ìœ ì‹</div>
                                </div>
                            </div>
                        </div>

                        <!-- ë²„íŠ¼ ê·¸ë£¹ -->
                        <div class="button-group">
                            <button type="submit" class="save-temp-btn">ì €ì¥</button>
                            <button type="reset" class="cancel-btn">ì·¨ì†Œ</button>
                        </div>
                    </div>
                </div>
                <div class="panel right-panel">ì˜¤ë¥¸ìª½ íŒ¨ë„</div>
            </div>
        </div>
    </form>

    <script type="text/javascript">
    
       function previewCompletedImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = input.parentElement.querySelector('.completed-preview-image');
                    const icon = input.parentElement.querySelector('.photo-icon');
                    img.src = e.target.result;
                    img.style.display = 'block';
                    icon.style.display = 'none';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
    
	//ë„¤ë¹„ê²Œì´ì…˜ ë°” í¬ê¸° ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
    function adjustBodyPadding() {
      const nav = document.getElementById('navbar');
      if (nav) {
        const navHeight = nav.offsetTop + nav.offsetHeight;
        document.body.style.paddingTop = navHeight + 'px';
      }
    }

    window.addEventListener('load', adjustBodyPadding);
    window.addEventListener('resize', adjustBodyPadding);
    
    // ìš”ë¦¬ ëŒ€í‘œ ì‚¬ì§„ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° í•¨ìˆ˜
    function previewMainImage(input) {
        var file = input.files[0];
        var previewImage = input.parentElement.querySelector('.main-preview-image');
        var icon = input.parentElement.querySelector('.photo-icon');
        var text = input.parentElement.querySelector('.image-text');

        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                previewImage.src = e.target.result;
                previewImage.style.display = 'block';
                icon.style.display = 'none';
                text.style.display = 'none';
            };
            reader.readAsDataURL(file);
        }
    }
    
    function serializeIngredients() {
        const groups = document.querySelectorAll("#ingredients-container .ingredient-group");
        let ingredientsData = [];

        groups.forEach(group => {
            const groupName = group.querySelector(".ingredient-group-header").value.trim();
            const rows = group.querySelectorAll(".ingredient-row"); // ê·¸ë£¹ ë‚´ì˜ ëª¨ë“  ì¬ë£Œ í–‰ ì°¾ê¸°

            rows.forEach(row => {
                const inputs = row.querySelectorAll("input[type='text']");
                const ingredientName = inputs[0]?.value.trim();
                const quantity1 = inputs[1]?.value.trim();
                const quantity2 = inputs[2]?.value.trim();
                const quantity3 = inputs[3]?.value.trim();

                if (ingredientName || quantity1 || quantity2 || quantity3) {
                    ingredientsData.push({
                        group_name: groupName,
                        ingredient_name: ingredientName,
                        quantity1: quantity1,
                        quantity2: quantity2,
                        quantity3: quantity3
                    });
                }
            });
        });

        const ingredientsJson = JSON.stringify(ingredientsData);
        document.getElementById("ingredients-hidden").value = ingredientsJson;

        console.log("âœ… ì§ë ¬í™”ëœ ì¬ë£Œ ë°ì´í„°:", ingredientsJson);
    }

// ìš”ë¦¬ ìˆœì„œ ì§ë ¬í™” í•¨ìˆ˜ (í…ìŠ¤íŠ¸ì™€ ì´ë¯¸ì§€ í¬í•¨) - ìˆ˜ì •ëœ ë²„ì „
function serializeSteps() {
    const steps = [];
    const stepInputs = document.querySelectorAll(".step-item");
    
    stepInputs.forEach((item, index) => {
        const explanation = item.querySelector(".step-text-input")?.value.trim() || "";
        const imageInput = item.querySelector(".step-file-input");
        let imageKey = "";

        if (imageInput && imageInput.files[0]) {
            imageKey = "step_image_" + index; // ê° ì´ë¯¸ì§€ ì…ë ¥ í•„ë“œì— ê³ ìœ í•œ ì´ë¦„ ë¶€ì—¬
            imageInput.setAttribute("name", imageKey);
        }

        // ì„¤ëª…ì´ ìˆìœ¼ë©´ í•­ìƒ ì¶”ê°€ (ì´ë¯¸ì§€ëŠ” ì„ íƒì‚¬í•­)
        if (explanation) {
            steps.push({
                explanation: explanation,
                image: imageKey // íŒŒì¼ ì…ë ¥ í•„ë“œì˜ ì´ë¦„ ì €ì¥
            });
        }
    });
    
    // JSONìœ¼ë¡œ ë³€í™˜
    const stepsJson = JSON.stringify(steps);
    document.getElementById("steps-hidden").value = stepsJson;

    console.log("âœ… ì§ë ¬í™”ëœ ìš”ë¦¬ ìˆœì„œ:", stepsJson);
}

    // ë™ì˜ìƒ ë¯¸ë¦¬ë³´ê¸° í•¨ìˆ˜
    function previewVideo(input) {
        var file = input.files[0];
        var button = input.parentElement.querySelector('.video-button');
        var previewPlayer = button.querySelector('.video-preview-player');
        var icon = button.querySelector('.video-icon');
        var text = button.querySelector('.video-text');

        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                previewPlayer.src = e.target.result;
                previewPlayer.style.display = 'block'; // ë™ì˜ìƒ í‘œì‹œ
                icon.style.display = 'none'; // ì•„ì´ì½˜ ìˆ¨ê¹€
                text.style.display = 'none'; // í…ìŠ¤íŠ¸ ìˆ¨ê¹€
            };
            reader.readAsDataURL(file);
        }
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ìš”ì†Œì— ë¶™ì´ëŠ” í•¨ìˆ˜
    function attachEventListeners(element) {
        if (element) {
            element.addEventListener('click', function(e) {
                if (!e.target.classList.contains('main-preview-image') && 
                    !e.target.classList.contains('step-preview-image') && 
                    !e.target.classList.contains('completed-preview-image') &&
                    !e.target.classList.contains('video-preview-player')) {
                    var fileInput = element.querySelector('input[type="file"]');
                    if (fileInput) {
                        fileInput.click();
                    }
                }
            });
        }
    }

    // ì´ˆê¸° ë¡œë“œ ì‹œ ê¸°ì¡´ ìš”ì†Œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì ìš©
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.step-image-upload, .image-upload, .video-upload-container').forEach(item => {
      attachEventListeners(item);
  });
    });

    // ê¸°ì¡´ ìŠ¤í… ë° ì¬ë£Œ ê´€ë ¨ í•¨ìˆ˜
    var currentStepCount = 1;

    function addStep() {
        currentStepCount++;
        var stepsContainer = document.getElementById('steps-container');
        var newStepDiv = document.createElement('div');
        newStepDiv.className = 'step-item';
        
        var stepContent = '';
        stepContent += '<div class="step-header">';
        stepContent += '<div class="step-number">STEP ' + currentStepCount + '</div>';
        stepContent += '</div>';
        stepContent += '<div class="step-content">';
        stepContent += '<div class="step-text-container">';
        stepContent += '<textarea class="step-text-input" placeholder="ì˜ˆ) ë‹¤ìŒ ìš”ë¦¬ ë‹¨ê³„ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”."></textarea>';
        stepContent += '</div>';
        stepContent += '<div class="step-image-container">';
        stepContent += '<div class="step-image-upload">';
        stepContent += '<input type="file" class="step-file-input" name="step_image_' + (currentStepCount - 1) + '" accept="image/*" style="display: none;" onchange="previewStepImage(this)">';
        stepContent += '<div class="image-icon">+</div>';
        stepContent += '<img class="step-preview-image" style="max-width: 100%; max-height: 100%; display: none;" />';
        stepContent += '</div>';
        stepContent += '</div>';
        stepContent += '</div>';
        
        newStepDiv.innerHTML = stepContent;
        stepsContainer.insertBefore(newStepDiv, stepsContainer.lastElementChild); // ë²„íŠ¼ ì•ì— ì¶”ê°€
        attachEventListeners(newStepDiv.querySelector('.step-image-upload'));
    }

    function previewStepImage(input) {
        var file = input.files[0];
        var previewImage = input.parentElement.querySelector('.step-preview-image');
        var icon = input.parentElement.querySelector('.image-icon');
        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                previewImage.src = e.target.result;
                previewImage.style.display = 'block';
                icon.style.display = 'none';
            };
            reader.readAsDataURL(file);
        }
    }

    function previewCompletedImage(input) {
        var file = input.files[0];
        var previewImage = input.parentElement.querySelector('.completed-preview-image');
        var icon = input.parentElement.querySelector('.photo-icon');
        if (file) {
            var reader = new FileReader();
            reader.onload = function(e) {
                previewImage.src = e.target.result;
                previewImage.style.display = 'block';
                icon.style.display = 'none';
            };
            reader.readAsDataURL(file);
        }
    }

    // ì¬ë£Œ ì¶”ê°€ í•¨ìˆ˜
    function addIngredient() {
        var container = document.getElementById('ingredients-container');
        var newRow = document.createElement('div');
        newRow.className = 'ingredient-row';
        newRow.style.marginBottom = '10px';
        var newInputRow = `
            <div style="display: grid; grid-template-columns: 200px 1fr 100px 100px 1fr; gap: 10px; border-radius: 0px; overflow: hidden;">
                <input type="text" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="ì˜ˆ) ìƒˆ ì¬ë£Œ">
                <input type="text" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="10(ìˆ˜ëŸ‰)">
                <input type="text" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="ì˜ˆ) g,ml">
                <input type="text" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;" placeholder="ì˜ˆ) (ë¹„ê³ )">
            </div>
        `;
        newRow.innerHTML = newInputRow;
        container.insertBefore(newRow, container.lastElementChild);
    }
    
    // beforeSubmit í•¨ìˆ˜ ìˆ˜ì • (serializeSteps í˜¸ì¶œ)
	function beforeSubmit() {
	    // ì œëª© ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
	    const titleInput = document.querySelector("input[name='title']");
    	const title = titleInput.value.trim();
    	
    	//ì†Œê°œ
    	const descInput = document.querySelector("textarea[name='description']");
    	
    	//ìš”ë¦¬ ì™„ì„± ì‚¬ì§„
    	const completeImgInput = document.querySelector("input[name='complete_img']");
	
     
        
	    // ì œëª©ì´ ë¹„ì–´ìˆìœ¼ë©´ ê²½ê³  ë„ìš°ê³  ì œì¶œ ì¤‘ë‹¨
	    if (title === "") {
	        alert("ë ˆì‹œí”¼ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
	        titleInput.focus();
	        return;
	    }
	    
	 	// ì†Œê°œ í™•ì¸
	    if (!descInput.value.trim()) {
	        alert("ìš”ë¦¬ ì†Œê°œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
	        descInput.focus();
	        return;
	    }
	    
	 // ì™„ì„±ì‚¬ì§„ í™•ì¸
	    if (!completeImgInput || completeImgInput.files.length === 0) {
	        alert("ìš”ë¦¬ ì™„ì„±ì‚¬ì§„ì„ ë“±ë¡í•´ì£¼ì„¸ìš”.");
	        completeImgInput.click(); // ìë™ìœ¼ë¡œ íŒŒì¼ ì„ íƒì°½ ì—´ê¸°
	        return;
	    }
	 
	
	    serializeIngredients();  // ì¬ë£Œ ì§ë ¬í™”
	    serializeSteps();       // ìš”ë¦¬ ìˆœì„œ ì§ë ¬í™” (í…ìŠ¤íŠ¸ + ì´ë¯¸ì§€)
	
	    // ë””ë²„ê¹…ìš© ì¶œë ¥
	    console.log("ğŸ¥• ingredients:", document.getElementById("ingredients-hidden").value);
	    console.log("ğŸ“‹ steps:", document.getElementById("steps-hidden").value);
	
	    // í¼ ìˆ˜ë™ ì „ì†¡
	    document.querySelector("form").submit();
	}



    function addIngredientGroup() {
        const container = document.getElementById('ingredients-container');

        const group = document.createElement('div');
        group.className = 'ingredient-group';

        const headerInput = document.createElement('input');
        headerInput.type = 'text';
        headerInput.className = 'ingredient-group-header';
        headerInput.name = 'group_name[]';
        headerInput.placeholder = "ê·¸ë£¹ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"; // ì‚¬ìš©ì ì…ë ¥ ë°›ìŒ
        headerInput.required = true; // í•„ìˆ˜ ì…ë ¥ ì²˜ë¦¬ë„ ê°€ëŠ¥

        const row = createIngredientRow();

        group.appendChild(headerInput);
        group.appendChild(row);

        container.insertBefore(group, container.lastElementChild);
    }

    function addIngredientRow(button) {
        const container = document.getElementById('ingredients-container');
        const groups = container.getElementsByClassName('ingredient-group');
        if (groups.length === 0) {
            alert("ë¨¼ì € ê·¸ë£¹ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.");
            return;
        }

        const lastGroup = groups[groups.length - 1];
        const row = createIngredientRow();
        lastGroup.appendChild(row); // ê·¸ë£¹ ë‚´ë¶€ì— ì¶”ê°€
    }

    function createIngredientRow() {
        const row = document.createElement('div');
        row.className = 'ingredient-row';
        row.style.marginBottom = '10px';

        row.innerHTML = `
            <div style="display: grid; grid-template-columns: 200px 1fr 100px 100px 1fr; gap: 10px;">
                <input type="text" name="ingredient_name[]" placeholder="ì˜ˆ) ì¬ë£Œëª…" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;">
                <input type="text" name="quantity1[]" placeholder="ì˜ˆ) 10(ìˆ˜ëŸ‰)" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;">
                <input type="text" name="quantity2[]" placeholder="ì˜ˆ) g,ml" style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;">
                <input type="text" name="quantity3[]" placeholder="ì˜ˆ) ë¹„ê³ " style="background-color: #f1f1f1; padding: 8px; border: 1px solid #ddd; text-align: center; border-radius: 5px;">
            </div>
        `;

        return row;
    }
    
    
    </script>
</body>
</html>